-- MULTI-SCREEN AD ROTATOR
-- Displays 42x30 .nfp images on ALL connected monitors simultaneously
-- Supports: Wired Modems, Multiple Monitor Arrays

-- 1. FIND ALL MONITORS
-- We search for every peripheral of type "monitor"
local monitors = { peripheral.find("monitor") }

if #monitors == 0 then
    error("No Monitors Found! Check your wired modems.")
end

print("Detected " .. #monitors .. " monitor(s).")

-- 2. SETUP FUNCTION
-- Sets resolution to 42x30 (Scale 0.5) on all screens
for i, mon in ipairs(monitors) do
    mon.setTextScale(0.5)
    mon.setBackgroundColor(colors.black)
    mon.clear()
end

-- 3. DISPLAY FUNCTION
local function showAd(filename, duration)
    -- Check if file exists (Safety Check)
    if not fs.exists(filename) then
        -- Print error to the main computer terminal, not the screens
        print("Warning: Missing file " .. filename)
        
        -- Flash error on screens briefly
        for _, mon in ipairs(monitors) do
            term.redirect(mon)
            mon.setCursorPos(1,1)
            mon.setTextColor(colors.red)
            mon.write("FILE MISSING: " .. filename)
        end
        sleep(2)
        return
    end

    -- Load the image into memory once
    local image = paintutils.loadImage(filename)

    -- Draw to EVERY monitor
    for _, mon in ipairs(monitors) do
        -- Redirect 'paintutils' to this specific monitor
        term.redirect(mon)
        
        -- Clear and Draw
        mon.setBackgroundColor(colors.black)
        mon.clear()
        paintutils.drawImage(image, 1, 1)
    end

    -- Restore control to the main computer terminal briefly (good practice)
    term.redirect(term.native())
    
    -- Hold the ad
    sleep(duration)
end

-- 4. THE MAIN LOOP
while true do
    -- Ad 1: Reactor
    showAd("reactor.nfp", 10)
    
    -- Ad 2: Minerals (Your EuroCorp Logo)
    showAd("minerals.nfp", 10)
    
    -- Ad 3: Subway
    showAd("subway.nfp", 10)
end
