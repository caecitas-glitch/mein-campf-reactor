-- SERVER SCRIPT (The Brain)
-- 1. MANUALLY open the modem on the TOP
-- If your modem is on a different side, change "top" to "right", "left", etc.
rednet.open("top")

print("Elevator Server Online. ID: " .. os.getComputerID())
print("Modem is OPEN on: top")

-- CONFIGURATION
local floorMap = {
    [1] = "back",   -- Floor 1 Link
    [2] = "right",  -- Floor 2 Link
    [3] = "left"    -- Floor 3 Link
}

while true do
    local id, message = rednet.receive("elevator_cmd")
    
    if type(message) == "table" and message.floor then
        local target = message.floor
        local side = floorMap[target]
        
        if side then
            print("Command Received. Target: " .. target)
            rs.setOutput(side, true)
            sleep(4) 
            rs.setOutput(side, false)
        end
    end
end
